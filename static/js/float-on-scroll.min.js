!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e=e||self).flowplayer=e.flowplayer||{},e.flowplayer["float_on-scroll"]=t())}(this,(function(){"use strict";var e={MOUNT:"mount",ERROR:"error",CONTEXT_MENU:"contextmenu",CLICK:"click",DBL_CLICK:"dblclick",KEYUP:"keyup",KEYDOWN:"keydown",LOAD:"load",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_ENTER:"fullscreenenter",FULLSCREEN_EXIT:"fullscreenexit",FULLSCREEN_CHANGE:"fullscreenchange",WEBKIT_NEEDKEY:"webkitneedkey",METADATA:"loadedmetadata",DATA:"loadeddata",PROGRESS:"progress",TIME_UPDATE:"timeupdate",LOAD_START:"loadstart",VOLUME_CHANGE:"volumechange",PAUSE:"pause",PLAYING:"playing",PLAY:"play",WAITING:"waiting",CAN_PLAY:"canplay",ENDED:"ended",SEEKED:"seeked",SEEKING:"seeking",DURATION_CHANGE:"durationchange",BEFORE_PLAY:"beforeplay",BEFORE_PAUSE:"beforepause",STATE:"state",CUEPOINTS:"cuepoints",CUEPOINT_START:"cuepointstart",CUEPOINT_END:"cuepointend",VIEW_ENTER:"viewenter",VIEW_LEAVE:"viewleave",SOURCE:"src",RECOVER:"recover",REAP:"reap",CONFIG:"config",QUALITIES:"qualities",SET_QUALITY:"quality:set",NON_RECOVERABLE_ERROR:"error:fatal",RECOMMENDATIONS_READY:"recommendationsready",AUDIO_ONLY_SOURCE:"audioonlysource"};var t=[].slice;function n(e,t,n){for(t=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(t);t.length;){if(null==e)return n;e=e[t.shift()]}return null==e?n:e}var o="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;var r=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}()&&{passive:!0},i=["touchstart","touchmove"];function a(e){return e.emit=function(t,n,o){o=o||{};var r=function(e){var t=document.createEvent("Event");return t.initEvent(e,!1,!0),t}(t);return n&&function(e,t){for(var n in t)e[n]=t[n]}(r,{data:n||{}}),e.dispatchEvent(r),!1===o.return_self?r:e},e.on=function(t,n){return"string"==typeof t&&(t=t.split(" ")),t.forEach((function(t){return function(e){return~i.indexOf(e)}(t)?e.addEventListener(t,n,r):e.addEventListener(t,n)})),e},e.off=function(t,n){return e.removeEventListener(t,n),e},e.one=e.once=function(t,n){return e.on(t,(function o(r){e.off(t,o),n(r)}))},e}var u="",l=" ",s=Array.isArray,f="undefined"!=typeof window&&a(window),c="undefined"!=typeof document&&a(document),d=["span","a","em","p","i"],p=d.concat(["div","strong","video","img","ol","ul","li","script"]),E="__flowplayer__";function _(e,t,n){var o=m(document.createElement(e));if(s(t)&&(n=t,t=!1),s(n)||(n=[n]),o.append(n.filter((function(e){return e}))),"object"!=typeof t)return o;for(var r in t)r in o?o[r]=t[r]:o.setAttribute(r,t[r]);return o}function v(e){var n=e.tagName;e[E]=1,e.find=function(t){var n=e.querySelector(t);return n?m(n):n},e.html=function(t){return e.innerHTML=t,e},e.empty=function(){return e.innerHTML=u,e},e.offset=function(){var t={top:0,left:0},n=e;do{t.left+=n.offsetLeft||0,t.top+=n.offsetTop||0}while(n=n.offsetParent);return t},e.innerWidth=function(){var t=getComputedStyle(e);return e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)};var o=e.insert=function(t,n){return s(n)?n.map((function(n){return e.insert(t,n)}))[0]:m(n="string"==typeof n?e.insertAdjacentHTML(t,n):e.insertAdjacentElement?e.insertAdjacentElement(t,n):e.appendChild(n))};return e.append=o.bind(e,"beforeend"),e.prepend=o.bind(e,"afterbegin"),e.css=function(t,n){if("object"==typeof t){for(var o in t)e.css(o,t[o]);return e}return void 0===n?getComputedStyle(e)[t]:(1*n&&(n+="px"),e.style[t]=n,e)},e.show=function(){return e.css({display:~d.indexOf(n)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var t=e.parentNode;t&&t.removeChild(e)},e.attr=function(t,n){return null==n?e.getAttribute(t):(e.setAttribute(t,n),e)},e.txt=function(t){return e.textContent=t,e},e.fp=function(t){return e.addClass("fp-"+t)},e.addClass=function(t){return t.split(l).forEach((function(t){e.hasClass(t)||(e.className+=(e.className?l:u)+t)})),e},e.removeClass=function(t){t=t.split(l);var n=e.className.split(l);return e.className=n.filter((function(e){return!~t.indexOf(e)})).join(" "),e},e.toggleClass=function(t,n){return void 0===n&&(n=!e.hasClass(t)),n?e.addClass(t):e.removeClass(t)},e.findAll=function(n){return o=e.querySelectorAll(n),t.call(o);var o},e.hasClass=function(t){return~e.className.split(l).indexOf(t)},e}function m(e){return void 0===e?e:function(e){return e&&e[E]}(e)?e:v(a(e))}function A(e,t){if("string"==typeof e&&"<"==e[0])return _(e.slice(1,-1),t);if("string"!=typeof e)return m(e);var n=t instanceof HTMLElement&&t.querySelector(".fp-"+e)||document.querySelector(e);return n?m(n):void 0}A.window=f,A.document=c,A.el=_,p.forEach((function(e){A[e]=function(t,n){return"string"==typeof t&&(t={class:t}),_(e,t,n)}}));var O="float:pop:in",N="float:pop:out",y=Object.freeze({__proto__:null,POP_IN:O,POP_OUT:N});var g=1<<20,C=Object.freeze({__proto__:null,NO_STANDARD_CONTROLS:g}),T={coords:"-22 -22 122 122",link:"#fp-mute",translation_key:"core.mute",name:"fp-mute"},h={coords:"-22 -22 122 122",link:"#fp-unmute",translation_key:"core.mute",name:"fp-unmute"},w={coords:"19 0 80 80",link:"#fp-close",translation_key:"core.close",name:"fp-close"};function L(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function R(e){var t,n,o=L("svg");return o.setAttribute("viewBox",e.coords),e.name&&o.setAttribute("class",e.name),e.title&&o.setAttribute("title",e.title),e.title&&o.setAttribute("aria-label",e.title),o.setAttribute("tabindex","0"),o.appendChild((t=e.link,(n=L("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t),n)),A(o)}var S={PLACEHOLDER:void 0,FLOATING_CONTAINER:void 0},I={CONTAINER_NAME:"flowplayer-floating-container",PLACEHOLDER_NAME:"flowplayer-floating-placeholder",ON:"fp-on",FLOATING:"is-floating",NO_STD_CONTROLS:"no-standard-controls"},b=.8;function U(){return function(e){const t=e.getBoundingClientRect(),n=window.innerHeight,o=t.y;return o>n?0:o+t.height<0?0:t.y<0?(t.height+o)/t.height:n-t.y>t.height?1:Math.abs((n-t.y)/t.height)}(P())>b}function D(){return S.FLOATING_CONTAINER=S.FLOATING_CONTAINER||A.div().attr("id",I.CONTAINER_NAME)}function P(){return S.PLACEHOLDER=S.PLACEHOLDER||A.div().attr("id",I.PLACEHOLDER_NAME)}function M(e,t){var n=t.parentNode;n&&n.replaceChild(e,t)}function x(t,o,r){if(0!=r.reaper&&!r.floating){var i=D(),a=P(),u=A.p().txt(r._t("float_on_scroll.popped_out","video playing in floating mode"));a.empty().appendChild(u);var l=o.aspect_ratio.cloneNode(!1);l&&a.append(l),M(a,o),i.append(o),i.addClass(I.ON),i.toggleClass(I.NO_STD_CONTROLS,function(e){return g&n(e,"opts.ui",0)}(r)),t.pop_out_container.appendChild(i),r.emit(e.RESIZE),r.emit(N)}}function k(t,n,o){if(0!=o.reaper&&o.floating){var r=D();M(n,P()),r.removeClass(I.ON),r.parentElement.removeChild(r),o.emit(e.RESIZE),o.emit(O)}}var H="is-popped-out";function F(t,r,i){if(!(t.multiplay||"float_on_scroll"in t&&0==t.float_on_scroll)){(function(){try{return window.self!==window.top}catch(e){return!0}})()&&console.warn("iframe detected - floating player not supported in iframe");var a={pop_out_container:n(t,"float_on_scroll.container",document.body),was_user_toggled:!1},u=n(r,"ui.header");u&&function(e,t,n,o){var r=A.div("fp-exit-float");r.append(R(w).attr("role","button")),r.on("click",(function(){t.was_user_toggled=!0,o.togglePlay(!1),k(0,n,o)})),e.append(r);var i=A.div("fp-mute-float"),a=R(T).attr("role","button"),u=R(h).attr("role","button");i.append([a,u]),i.on("click",(function(){o.toggleMute(!o.muted)})),e.append(i)}(u,a,r,i);var l,s,f,c,d,p,E=(l=function(){U()&&k(0,r,i)},f=s||60,c=Math.ceil(1e3/f),d=0,p=null,function(){var e=Date.now()-d;null===p&&(p=o((function(){p=null,l.apply(this,arguments),d=Date.now()}),c-e))});i.on(e.VIEW_LEAVE,(function(){i.paused||a.was_user_toggled||x(a,r,i)})),i.on(e.VIEW_ENTER,(function(){a.was_user_toggled=!1})),i.on(N,(function(){window.on("scroll",E),i.floating=!0,i.setState(H,!0)})),i.on(O,(function(){window.off("scroll",E),i.floating=!1,i.setState(H,!1)}))}}return F.events=y,F.flags=C,function(e,t){if("object"==typeof exports&&"undefined"!=typeof module)return t;"flowplayer"in e||(e.flowplayer={extensions:[]});var n=e.flowplayer;return"function"==typeof n?(n(t),t):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(t)||n.extensions.push(t),t)}(window,F)}));
