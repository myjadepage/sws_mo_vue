!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t=t||self).flowplayer=t.flowplayer||{},t.flowplayer.thumbnails=n())}(this,(function(){"use strict";function t(t){return"function"==typeof t}function n(){throw new Error("Function was expected as Argument[0]")}var e=[].slice;function r(i){if(!(this instanceof r))return new r(i);var o=this;return o.data=i,o.tap=function(){var i=e.call(arguments),a=i.shift();return a==r.lift?o.data:t(a)?(a.apply(o,[o.data].concat(i)),o):void n()},o.into=o.fmap=function(){var i=e.call(arguments),a=i.shift();return a==r.lift?o.data:t(a)?r(a.apply(o,[o.data].concat(i))):void n()},o.unwrap=function(){return o.data},o}r.of=r,r.lift=function(t){return t instanceof r?t.data:t},r._apply=function(t,n){if(0==n.length)return t();if(1==n.length)return t(n[0]);if(2==n.length)return t(n[0],n[1]);if(3==n.length)return t(n[0],n[1],n[2]);if(4==n.length)return t(n[0],n[1],n[2],n[3]);if(5==n.length)return t(n[0],n[1],n[2],n[3],n[4]);throw new Error("Pipe._apply() does not support arity > 5")},r.maybe=function(t,n,i){return t?r._apply(n,[t].concat(e.call(arguments,2,arguments.length))):t},r.curry=function(t,n,i){return(n=n||[]).length>t.length-1?t.apply(i,n):function(){return n=n.concat(e.call(arguments)),r.curry(t,n,i)}};var i="mount",o="config",a=[].slice;function u(t,n){for(var e in n)t[e]=n[e];return t}function f(){var t=a.call(arguments),n=t.shift();return t.reduce(u,n)}function c(t){return Array.isArray(t)?t.slice(0):t.split(".")}function s(t,n,e){for(n=c(n);n.length;){if(null==t)return e;t=t[n.shift()]}return null==t?e:t}function l(t,n,e){var r=(n=c(n)).pop(),i=s(t,n);return i&&(i[r]=e),t}var d=!!function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}catch(t){}return t}()&&{passive:!0},p=["touchstart","touchmove"];function h(t){return t.emit=function(n,e,r){r=r||{};var i=function(t){var n=document.createEvent("Event");return n.initEvent(t,!1,!0),n}(n);return e&&u(i,{data:e||{}}),t.dispatchEvent(i),!1===r.return_self?i:t},t.on=function(n,e){return"string"==typeof n&&(n=n.split(" ")),n.forEach((function(n){return function(t){return~p.indexOf(t)}(n)?t.addEventListener(n,e,d):t.addEventListener(n,e)})),t},t.off=function(n,e){return t.removeEventListener(n,e),t},t.one=t.once=function(n,e){return t.on(n,(function r(i){t.off(n,r),e(i)}))},t}var m="",v=" ",y=Array.isArray,g="undefined"!=typeof window&&h(window),w="undefined"!=typeof document&&h(document),b=["span","a","em","p","i"],x=b.concat(["div","strong","video","img","ol","ul","li","script"]),E="__flowplayer__";function A(t,n,e){var r=T(document.createElement(t));if(y(n)&&(e=n,n=!1),y(e)||(e=[e]),r.append(e.filter((function(t){return t}))),"object"!=typeof n)return r;for(var i in n)i in r?r[i]=n[i]:r.setAttribute(i,n[i]);return r}function C(t){var n=t.tagName;t[E]=1,t.find=function(n){var e=t.querySelector(n);return e?T(e):e},t.html=function(n){return t.innerHTML=n,t},t.empty=function(){return t.innerHTML=m,t},t.offset=function(){var n={top:0,left:0},e=t;do{n.left+=e.offsetLeft||0,n.top+=e.offsetTop||0}while(e=e.offsetParent);return n},t.innerWidth=function(){var n=getComputedStyle(t);return t.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)};var e=t.insert=function(n,e){return y(e)?e.map((function(e){return t.insert(n,e)}))[0]:T(e="string"==typeof e?t.insertAdjacentHTML(n,e):t.insertAdjacentElement?t.insertAdjacentElement(n,e):t.appendChild(e))};return t.append=e.bind(t,"beforeend"),t.prepend=e.bind(t,"afterbegin"),t.css=function(n,e){if("object"==typeof n){for(var r in n)t.css(r,n[r]);return t}return void 0===e?getComputedStyle(t)[n]:(1*e&&(e+="px"),t.style[n]=e,t)},t.show=function(){return t.css({display:~b.indexOf(n)?"inline":"block"})},t.hide=function(){return t.css({display:"none"})},t.remove=function(){var n=t.parentNode;n&&n.removeChild(t)},t.attr=function(n,e){return null==e?t.getAttribute(n):(t.setAttribute(n,e),t)},t.txt=function(n){return t.textContent=n,t},t.fp=function(n){return t.addClass("fp-"+n)},t.addClass=function(n){return n.split(v).forEach((function(n){t.hasClass(n)||(t.className+=(t.className?v:m)+n)})),t},t.removeClass=function(n){n=n.split(v);var e=t.className.split(v);return t.className=e.filter((function(t){return!~n.indexOf(t)})).join(" "),t},t.toggleClass=function(n,e){return void 0===e&&(e=!t.hasClass(n)),e?t.addClass(n):t.removeClass(n)},t.findAll=function(n){return e=t.querySelectorAll(n),a.call(e);var e},t.hasClass=function(n){return~t.className.split(v).indexOf(n)},t}function T(t){return void 0===t?t:function(t){return t&&t[E]}(t)?t:C(h(t))}function _(t,n){if("string"==typeof t&&"<"==t[0])return A(t.slice(1,-1),n);if("string"!=typeof t)return T(t);var e=n instanceof HTMLElement&&n.querySelector(".fp-"+t)||document.querySelector(t);return e?T(e):void 0}_.window=g,_.document=w,_.el=A,x.forEach((function(t){_[t]=function(n,e){return"string"==typeof n&&(n={class:n}),A(t,n,e)}}));var k="anonymous",L="use-credentials";function j(t,n){if(function(t){switch(t){case"":case k:case L:return!0;default:console.warn("Invalid(crossorigin: %s) must be one of '', 'anonymous', or 'use-credentials'\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes",t)}}(n=n||k),t.crossOrigin!=n)return t.attr("crossorigin",n),t}function M(t){var n=document.createElement("a");return n.href=t,n.origin}function O(t,n){return t.querySelector("track[id='"+n+"']")}function S(t,n){var e=_(document.createElement("track"));return f(e,n),function(t,n){try{return t.src.indexOf("blob:"),M(t.src)!==M(n)}catch(t){return console.error(t),!0}}(t,n.src)&&(j(t),j(e)),t.appendChild(e)}var N="with-thumbnail",P=/#xywh=(\d+),(\d+),(\d+),(\d+)$/,q=/^(https:|https:|\/)/;function H(t,n){for(t=t.slice(0);t.length;){var e=t.shift();if(e.startTime<=n&&n<=e.endTime)return e}}var W={h:"height",w:"width",x:"x",y:"y"};function F(t,n){if(0!=t.length)return~t.match(P)?function(t){var n=t.indexOf("#"),e=t.slice(0,n),r=t.slice(n+1,t.length).split("="),i=r[0].split(""),o=r[1].split(",");return i.reduce((function(t,n,e){return l(t,W[n],o[e])}),{path:e})}(t):f({},n,{path:t})}function I(t){return t.removeClass(N),t.removeAttribute("style")}function R(t,n,e,r){var i=r.find(".fp-timeline").offsetWidth,o=parseInt(t.width,10),a=o/2,u=Math.round(i*(e/100))-a,f=Math.min(i-o,Math.max(u,0));return n.addClass(N).css({backgroundImage:["url(",t.path,")"].join(""),backgroundPositionX:t.x+"px ",backgroundPositionY:"-"+t.y+"px",height:t.height,width:t.width,left:f+"px",marginTop:"-"+t.height+"px"})}var z="thumbnails:render",U=[].slice,X="thumbnails",Y="_behavior.kinds.vod.tooltip_update",$="_behavior.kinds.live.tooltip_update";function B(t){var n=O(t,X);n&&n.remove(),t.reaper.put(X,[])}return function(t,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in t||(t.flowplayer={extensions:[]});var e=t.flowplayer;return"function"==typeof e?(e(n),n):(Array.isArray(e.extensions)||(e.extensions=[]),~e.extensions.indexOf(n)||e.extensions.push(n),n)}(window,(function(t,n,e){e.reaper.put("thumbnails",[]),e.one(i,(function(){!function(t){var n={vod:s(t,Y),live:s(t,$)},e=function(t,e,r,i){I(r.timestamp),n[i].apply(this,arguments),e.emit(z,f({},t,{controls:r}))};l(t,Y,e),l(t,$,e)}(e)})),e.on(z,(function(i){var o=s(i,"data.controls"),a=s(i,"data.percent");if(o&&"number"==typeof a){var u=r.of(e.duration*(a/100)).fmap(Math.min,e.duration).fmap(Math.max,0).unwrap();r.of(e.thumbnails).fmap(H,u).fmap(s,"src","").fmap(F,s(t,"thumbnails",{})).fmap(r.maybe,R,o.timestamp,a,n)}})),e.textTracks.onaddtrack=function(t){var n=t.track;if(n.id===X){var r=O(e,X);r&&(r.onload=r.onerror=function(t){if("error"==t.type)return console.error(t.type,t);l(e,"thumbnails",U.call(n.cues).map((function(t){return function(t,n){return{src:t.text.match(q)?t.text:function(t,n){const e=n.split("/");return e.pop(),e.push(t),e.join("/")}(t.text,n),endTime:t.endTime,startTime:t.startTime}}(t,r.src)})))},n.mode="hidden")}},e.on(o,(function(t){var n=s(t.data,"thumbnails.src",!1);if("string"==typeof n)return function(t,n){if(!function(t,n){return t.querySelector("track[src='"+n+"']")}(t,n))return B(t),new S(t,{kind:"metadata",src:n,id:X})}(e,n);var r=s(t.data,"thumbnails.thumbs",!1);return Array.isArray(r)?function(t,n){B(t),t.reaper.put(X,n)}(e,r):void 0}))}))}));
